<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>èŠ±è“®è»ŠéšŠ - å…¨è‡ªå‹•æ¬å®¶å·¥å…·</title>
    <style>
        body { font-family: "Microsoft JhengHei", monospace; background: #222; color: #fff; padding: 20px; }
        h1 { border-bottom: 1px solid #555; padding-bottom: 10px; color: #00bcd4; }
        .card { background: #333; padding: 15px; margin-bottom: 10px; border-radius: 5px; border-left: 5px solid #555; }
        .card.success { border-left-color: #2ecc71; }
        .card.error { border-left-color: #e74c3c; }
        button { background: #2ecc71; color: #fff; font-size: 22px; font-weight: bold; padding: 15px 40px; border: none; cursor: pointer; border-radius: 50px; box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4); transition: transform 0.1s; }
        button:active { transform: scale(0.95); }
        #log { margin-top: 20px; }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>

    <h1>ğŸš€ å¸æ©Ÿåå–® -> Firebase æ¬å®¶å·¥å…·</h1>
    <p>æˆ‘å·²ç¶“å¹«ä½ æ•´ç†å¥½ä»¥ä¸‹ 7 ä½å¸æ©Ÿçš„è³‡æ–™ï¼Œé»æ“ŠæŒ‰éˆ•å³å¯ä¸Šå‚³ï¼š</p>
    
    <button onclick="startMigration()">ğŸš€ å¯«å…¥ 7 ç­†å¸æ©Ÿè³‡æ–™</button>
    
    <div id="log"></div>

<script>
    // 1. åˆå§‹åŒ– Firebase
    const firebaseConfig = {
        databaseURL: "https://hualientaxi-bb32f-default-rtdb.asia-southeast1.firebasedatabase.app/",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 2. æˆ‘å¹«ä½ æ¸…æ´—å¥½çš„è³‡æ–™ (JSON æ ¼å¼)
    const DRIVERS_DATA = [
        { id: "U467348846c6b1fa433990d7b75c935b5", name: "éŠ˜", car: "TDP-1123", phone: "0976981123" },
        { id: "U162efcb17ca7b3278023bc15bbc426ef", name: "éš†", car: "TDP-1232", phone: "0935050681" },
        { id: "U355b824bc65ac487d16f7b35cabf4295", name: "æ˜¥", car: "TDP-1135", phone: "0939836422" },
        { id: "U887e387fbc192f621c64ab139b9a05d8", name: "æ˜‡", car: "TDP-1107", phone: "0958551588" },
        { id: "U2c8435bea724439172193bfcb9d8f790", name: "é ˜èˆªå“¡", car: "900-E9", phone: "0921171579" },
        { id: "U6553aef6bfaca5394d9afde914fde1fc", name: "å°æ±Ÿ", car: "TBA-227", phone: "0936739109" },
        { id: "Ubc8e3de03eaf78f9c32fccf3cc7ba246", name: "å§œç¦æ¦®", car: "727-E9", phone: "0928703959" }
    ];

    function log(msg, type = '') {
        const el = document.getElementById('log');
        const div = document.createElement('div');
        div.className = `card ${type}`;
        div.innerHTML = msg;
        el.prepend(div);
    }

    function startMigration() {
        if(!confirm("ç¢ºå®šè¦å°‡é€™ 7 ç­†è³‡æ–™å¯«å…¥ Firebase å—ï¼Ÿ")) return;

        DRIVERS_DATA.forEach(driver => {
            // æº–å‚™è¦å¯«å…¥çš„è³‡æ–™ç‰©ä»¶
            const updateData = {
                name: driver.name,
                car: driver.car,
                phone: driver.phone,
                role: "driver",          // æ¨™è¨˜èº«ä»½
                staticDataSynced: true,  // æ¨™è¨˜å·²æ¬å®¶
                lastUpdate: Date.now()   // æ›´æ–°æ™‚é–“
            };

            // å¯«å…¥ Firebase (ä½¿ç”¨ update ä»¥ä¿ç•™ç¾æœ‰ç¶“ç·¯åº¦)
            db.ref('drivers/' + driver.id).update(updateData)
                .then(() => {
                    log(`âœ… <b>${driver.name}</b> (${driver.car}) è³‡æ–™åŒæ­¥æˆåŠŸï¼`, 'success');
                })
                .catch(err => {
                    log(`âŒ <b>${driver.name}</b> å¤±æ•—: ${err.message}`, 'error');
                });
        });
    }
</script>
</body>
</html>
