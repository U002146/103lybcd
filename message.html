<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¿«é€Ÿå›è¦†:é è¨­è¨Šæ¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

    <style>
        /* é‡å°é•·è¼©å„ªåŒ–çš„å­—é«”è¨­å®š */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans TC", sans-serif;
            -webkit-tap-highlight-color: transparent; /* ç§»é™¤é»æ“Šé«˜äº® */
        }
        /* é˜²æ­¢ iOS æ©¡çš®ç­‹æ²å‹•æ•ˆæœï¼Œå›ºå®šç•«é¢ */
        html, body {
            overscroll-behavior: none;
            height: 100%;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

    <header class="bg-white px-4 py-3 shadow-sm z-10 sticky top-0">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-gray-500">ç›®å‰ä¹˜å®¢</p>
                <h1 id="user-name" class="text-xl font-bold text-gray-800">è¼‰å…¥ä¸­...</h1>
            </div>
            <div id="status-badge" class="px-3 py-1 bg-gray-200 text-gray-600 rounded-full text-xs font-bold">
                åˆå§‹åŒ–...
            </div>
        </div>
    </header>

    <main class="flex-1 p-3 overflow-y-auto">
        <div id="button-grid" class="grid grid-cols-2 gap-3 pb-10">
            </div>
    </main>

    <div id="loading-mask" class="fixed inset-0 bg-black/60 z-50 hidden flex flex-col items-center justify-center">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-white mb-4"></div>
        <p class="text-white text-xl font-bold tracking-widest">å‚³é€ä¸­...</p>
    </div>

    <div id="error-screen" class="fixed inset-0 bg-white z-[60] hidden flex flex-col items-center justify-center p-8 text-center">
        <i data-lucide="smartphone-off" class="w-20 h-20 text-red-500 mb-4"></i>
        <h2 class="text-2xl font-bold text-gray-800 mb-2">è«‹åœ¨ LINE é–‹å•Ÿ</h2>
        <p class="text-gray-500 text-lg">æ­¤åŠŸèƒ½åƒ…é™æ–¼ LINE App å…§éƒ¨ä½¿ç”¨ä»¥ç¢ºä¿é€šè¨ŠåŠŸèƒ½æ­£å¸¸ã€‚</p>
    </div>

    <script>
        // ==========================================
        // CONFIGURATION
        // ==========================================
        const MY_LIFF_ID = "2008907691-RTngSWg0"; // ã€è«‹æ›¿æ›é€™è£¡ã€‘

        // ==========================================
        // DATA STRUCTURE (12 Buttons)
        // ==========================================
        const buttonsData = [
            // Row 1: æœƒåˆå¾®èª¿ (ä¸Šè»Šå‰)
            { id: 1, label: "æˆ‘åœ¨é€™ç­‰", color: "bg-emerald-600", icon: "store", msg: "ğŸ“ æˆ‘å·²ç¶“åœ¨æŒ‡å®šåœ°é»ï¼ˆå®¶é–€å£ï¼å··å£ï¼åœ°æ¨™ï¼‰ç­‰å€™ï¼Œè«‹ç•™æ„ä¸€ä¸‹ï¼Œè¬è¬ã€‚" },
            { id: 2, label: "ç‰¹å¾µè¾¨è­˜", color: "bg-emerald-500", icon: "scan-face", msg: "ğŸ‘€ æˆ‘ç©¿è‘—é¡¯çœ¼è¡£ç‰©ï¼ˆæ­£åœ¨æ®æ‰‹ï¼‰ï¼Œè«‹ç•™æ„è·¯é‚Šé•·è¼©ã€‚" },
            
            // Row 2: å‹•ä½œè¼”åŠ© (ä¸Šè»Šæ™‚)
            { id: 3, label: "å”åŠ©ä¸Šè»Š", color: "bg-orange-500", icon: "hand-helping", msg: "ğŸ–ï¸ æˆ‘è¡Œå‹•æ¯”è¼ƒæ…¢ï¼Œéº»ç…©å¸æ©Ÿå¤§å“¥å”åŠ©æˆ‘ä¸Šä¸‹è»Šï¼Œè¬è¬ã€‚" },
            { id: 4, label: "é–‹å¾Œè»Šå»‚", color: "bg-orange-500", icon: "car-front", msg: "ğŸ§³ æˆ‘æœ‰å¤§è¡Œæ/è¼ªæ¤…ï¼Œéº»ç…©å¹«æˆ‘é–‹å¾Œè»Šå»‚ï¼Œè¬è¬ã€‚" }, // changed 'car' to 'car-front' for clearer vehicle look
            
            // Row 3: ç·©è¡æ™‚é–“ (ç­‰å¾…ä¸­)
            { id: 5, label: "æ…¢æ…¢èµ°å»", color: "bg-gray-500", icon: "footprints", msg: "ğŸ¢ æˆ‘æ­£åœ¨æ…¢æ…¢èµ°éå»ï¼Œè«‹ç¨å¾®ç­‰æˆ‘ä¸€ä¸‹ï¼Œè¬è¬è€å¿ƒã€‚" },
            { id: 6, label: "çœ‹åˆ°è»Šäº†", color: "bg-teal-600", icon: "eye", msg: "ğŸ‘‹ æˆ‘çœ‹åˆ°ä½ çš„è»Šäº†ï¼é¦¬ä¸Šéå»ã€‚" },
            
            // Row 4: ä¹˜è»Šé«”é©— (è¡Œé§›ä¸­)
            { id: 7, label: "å®‰éœä¼‘æ†©", color: "bg-purple-500", icon: "volume-x", msg: "ğŸ¤« ä»Šå¤©æœ‰é»ç´¯æƒ³ä¼‘æ¯ï¼Œè»Šå…§è«‹ä¿æŒå®‰éœï¼Œä¸éœ€èŠå¤©ï¼Œè¬è¬æ‚¨ã€‚" },
            { id: 8, label: "è«‹æ…¢æ…¢é–‹", color: "bg-purple-500", icon: "shield-check", msg: "ğŸ›¡ï¸ æˆ‘ä¸è¶•æ™‚é–“ï¼Œè«‹é †é †é–‹å°±å¥½ï¼Œå®‰å…¨ç¬¬ä¸€ï¼Œè¬è¬å¸æ©Ÿã€‚" },
            
            // Row 5: é‡‘æµç¢ºèª (ä¸‹è»Šå‰)
            { id: 9, label: "æˆ‘ä»˜ç¾é‡‘", color: "bg-indigo-500", icon: "coins", msg: "ğŸ’° æˆ‘æœƒä»˜ç¾é‡‘ï¼Œæˆ‘æœ‰æº–å‚™å¥½é›¶éŒ¢å–”ï¼" },
            { id: 10, label: "åˆ·æ•¬è€å¡", color: "bg-indigo-500", icon: "smartphone-nfc", msg: "ğŸ’³ æˆ‘è¦åˆ·ã€Œæ•¬è€å¡ï¼æ„›å¿ƒå¡ã€æ‰£é»æ•¸ï¼Œéº»ç…©æ‚¨å”åŠ©æ“ä½œåˆ·å¡æ©Ÿï¼Œè¬è¬ã€‚" },
            
            // Row 6: çµæŸèˆ‡ç·Šæ€¥ (ä¸‹è»Šå¾Œ)
            { id: 11, label: "è¬è¬å¸æ©Ÿ", color: "bg-rose-500", icon: "heart-handshake", msg: "ğŸ’– å¸æ©Ÿå¤§å“¥/å¤§å§è¾›è‹¦äº†ï¼è¬è¬ä½ ä¾†è¼‰æˆ‘ã€‚" },
            { id: 12, label: "éºè½ç‰©å“", color: "bg-red-600", icon: "alert-circle", msg: "â— ä¸å¥½æ„æ€ï¼æˆ‘å¥½åƒæœ‰æ±è¥¿éºè½åœ¨è»Šä¸Šï¼Œéº»ç…©æ‚¨ç¢ºèªä¸€ä¸‹ï¼" }
        ];

        // ==========================================
        // DOM ELEMENTS
        // ==========================================
        const ui = {
            grid: document.getElementById('button-grid'),
            loading: document.getElementById('loading-mask'),
            error: document.getElementById('error-screen'),
            userName: document.getElementById('user-name'),
            status: document.getElementById('status-badge')
        };

        // ==========================================
        // FUNCTIONS
        // ==========================================

        /**
         * æ¸²æŸ“æŒ‰éˆ•ä»‹é¢
         * AgeTech é‡é»ï¼šå¤§å­—é«”ã€å¤§åœ–æ¨™ã€é«˜å°æ¯”
         */
        function renderButtons() {
            ui.grid.innerHTML = buttonsData.map(btn => `
                <button 
                    onclick="handleButtonClick('${btn.msg}')"
                    class="${btn.color} text-white rounded-2xl shadow-md active:scale-95 transition-transform duration-100 flex flex-col items-center justify-center h-28 w-full relative overflow-hidden group"
                >
                    <div class="absolute -top-4 -right-4 w-16 h-16 bg-white opacity-10 rounded-full pointer-events-none"></div>
                    
                    <i data-lucide="${btn.icon}" class="w-10 h-10 mb-2 stroke-[2px]"></i>
                    
                    <span class="text-xl font-bold tracking-wide leading-tight">${btn.label}</span>
                </button>
            `).join('');
            
            // é‡æ–°åˆå§‹åŒ–åœ–æ¨™
            lucide.createIcons();
        }

        /**
         * è™•ç†é»æ“Šäº‹ä»¶
         * åŒ…å« Debounce èˆ‡ UI Feedback
         */
        async function handleButtonClick(messageText) {
            // 1. é¡¯ç¤ºé®ç½© (é˜²æ­¢é›™æ“Š)
            ui.loading.classList.remove('hidden');

            try {
                if (!liff.isInClient()) {
                    throw new Error("è«‹åœ¨ LINE App ä¸­é–‹å•Ÿæ­¤é é¢");
                }

                // 2. ç™¼é€è¨Šæ¯
                await liff.sendMessages([{
                    type: 'text',
                    text: messageText
                }]);

                // 3. æˆåŠŸå¾Œé—œé–‰è¦–çª— (çµ¦äºˆä¸€é»å»¶é²è®“ç”¨æˆ¶çœ‹åˆ°è½‰åœˆçµæŸçš„æ„Ÿè¦ºï¼Œæ›´å®‰å¿ƒ)
                setTimeout(() => {
                    liff.closeWindow();
                }, 500);

            } catch (error) {
                console.error('Send Error:', error);
                alert('ç™¼é€å¤±æ•—ï¼š' + error.message);
                ui.loading.classList.add('hidden'); // å¤±æ•—æ‰è§£é–ç•«é¢è®“ç”¨æˆ¶é‡è©¦
            }
        }

        /**
         * åˆå§‹åŒ– LIFF
         */
        async function initLiff() {
            try {
                await liff.init({ liffId: MY_LIFF_ID });

                if (!liff.isInClient()) {
                    ui.error.classList.remove('hidden');
                    return;
                }

                // å–å¾—ç”¨æˆ¶è³‡æ–™
                if (liff.isLoggedIn()) {
                    const profile = await liff.getProfile();
                    ui.userName.textContent = `Hi, ${profile.displayName}`;
                    ui.status.textContent = "å·²é€£ç·š";
                    ui.status.className = "px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold";
                } else {
                    liff.login();
                }

            } catch (error) {
                console.error('LIFF Init Failed', error);
                ui.userName.textContent = "é€£ç·šéŒ¯èª¤";
                ui.status.textContent = "Error";
                ui.status.className = "px-3 py-1 bg-red-100 text-red-700 rounded-full text-xs font-bold";
                alert('ç³»çµ±åˆå§‹åŒ–å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ– LIFF ID');
            }
        }

        // ==========================================
        // INIT
        // ==========================================
        window.onload = () => {
            renderButtons();
            initLiff();
        };

    </script>
</body>
</html>
